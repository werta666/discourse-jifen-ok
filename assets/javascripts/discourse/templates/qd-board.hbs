{{! 积分排行榜模板 - 游戏风格舞台布局 }}
<div class="qd-page qd-board--neo">
  <div class="qd-container">
    <div class="qd-card">
      <div class="board-header">
        <h2 class="board-title">🏆 积分排行榜</h2>
        <p class="board-subtitle">前五名荣耀展示</p>
      </div>

      {{#if this.requiresLogin}}
        {{! 未登录状态的友好提示 }}
        <div class="board-login-prompt">
          <div class="login-icon">🔐</div>
          <h3 class="login-title">需要登录</h3>
          <p class="login-message">{{this.loginMessage}}</p>
          <LinkTo @route="login" class="login-button">
            立即登录
          </LinkTo>
        </div>
      {{else}}
        {{! 已登录状态显示排行榜 }}
        
        {{! 分页信息显示 }}
        <div class="board-pagination-info">
          <span class="pagination-stats">
            显示前 {{this.displayCount}} 名用户，当前第 {{this.currentPage}} / {{this.totalPages}} 页
          </span>
        </div>

        {{! 舞台/领奖台布局（仅在第一页显示前三名）}}
        {{#if this.showPodium}}
          <div class="board-stage">
            <div class="podium">
              {{#if this.secondUser}}
                <div class="podium-position podium-position--second">
                  <div class="{{this.medalClass this.secondUser.rank}}">
                    <span class="medal-rank">{{this.secondUser.rank}}</span>
                  </div>
                  <div class="podium-user">{{this.secondUser.username}}</div>
                  <div class="podium-score">+{{this.secondUser.points}} 分</div>
                </div>
              {{/if}}

              {{#if this.firstUser}}
                <div class="podium-position podium-position--first">
                  <div class="{{this.medalClass this.firstUser.rank}}">
                    <span class="medal-rank">{{this.firstUser.rank}}</span>
                  </div>
                  <div class="podium-user">{{this.firstUser.username}}</div>
                  <div class="podium-score">+{{this.firstUser.points}} 分</div>
                </div>
              {{/if}}

              {{#if this.thirdUser}}
                <div class="podium-position podium-position--third">
                  <div class="{{this.medalClass this.thirdUser.rank}}">
                    <span class="medal-rank">{{this.thirdUser.rank}}</span>
                  </div>
                  <div class="podium-user">{{this.thirdUser.username}}</div>
                  <div class="podium-score">+{{this.thirdUser.points}} 分</div>
                </div>
              {{/if}}
            </div>
          </div>
        {{/if}}

        {{! 排行榜列表 }}
        {{#if this.listData}}
          <div class="board-list">
            {{#each this.listData as |user|}}
              <div class="board-item">
                <div class="board-rank">#{{user.rank}}</div>
                <div class="board-user">{{user.username}}</div>
                <div class="board-score">+{{user.points}} 分</div>
              </div>
            {{/each}}
          </div>
        {{/if}}

        {{! 分页导航 }}
        {{#if (gt this.totalPages 1)}}
          <div class="board-pagination">
            <button 
              class="pagination-btn pagination-btn--prev" 
              {{on "click" this.prevPage}}
              disabled={{not this.hasPrevPage}}
            >
              ← 上一页
            </button>

            <div class="pagination-numbers">
              {{#each this.pageNumbers as |pageNum|}}
                <button 
                  class="pagination-btn pagination-btn--number {{if (eq pageNum this.currentPage) 'active'}}" 
                  {{on "click" (fn this.goToPage pageNum)}}
                >
                  {{pageNum}}
                </button>
              {{/each}}
            </div>

            <button 
              class="pagination-btn pagination-btn--next" 
              {{on "click" this.nextPage}}
              disabled={{not this.hasNextPage}}
            >
              下一页 →
            </button>
          </div>
        {{/if}}
      {{/if}}

      {{! 底部操作区 }}
      <div class="board-footer">
        {{#if this.isAdmin}}
          <button 
            type="button" 
            class="btn btn-primary admin-refresh-btn" 
            {{on "click" this.refreshBoard}}
            disabled={{this.isLoading}}
            title="管理员专用：强制刷新排行榜缓存"
          >
            {{#if this.isLoading}}强制刷新中...{{else}}🔄 强制刷新{{/if}}
          </button>
        {{else}}
          <div class="cache-info">
            📊 数据每{{this.updateIntervalMinutes}}分钟自动更新
          </div>
        {{/if}}
        <span class="board-updated">
          {{#if this.minutesUntilNextUpdate}}
            距离下一次更新还需要 {{this.minutesUntilNextUpdate}} 分钟
          {{else}}
            即将更新...
          {{/if}}
        </span>
      </div>
    </div>
  </div>
</div>disabled={{this.isLoading}}
              >
                ← 上一页
              </button>
            {{/if}}

            <div class="pagination-info">
              <span class="pagination-current">{{this.pagination.current_page}}</span>
              <span class="pagination-separator">/</span>
              <span class="pagination-total">{{this.pagination.total_pages}}</span>
            </div>

            {{#if this.pagination.has_next}}
              <button 
                class="pagination-btn pagination-btn--next" 
                {{on "click" (fn this.loadPage (add this.pagination.current_page 1))}}
                disabled={{this.isLoading}}
              >
                下一页 →
              </button>
            {{/if}}
          </div>
        {{/if}}
      {{/if}}

      {{! 底部操作区 }}
      <div class="board-footer">
        {{#if this.isAdmin}}
          <button 
            type="button" 
            class="btn btn-primary admin-refresh-btn" 
            {{on "click" this.refreshBoard}}
            disabled={{this.isLoading}}
            title="管理员专用：强制刷新排行榜缓存"
          >
            {{#if this.isLoading}}强制刷新中...{{else}}🔄 强制刷新{{/if}}
          </button>
        {{else}}
          <div class="cache-info">
            📊 数据每{{this.updateIntervalMinutes}}分钟自动更新
          </div>
        {{/if}}
        <span class="board-updated">
          {{#if this.minutesUntilNextUpdate}}
            距离下一次更新还需要 {{this.minutesUntilNextUpdate}} 分钟
          {{else}}
            即将更新...
          {{/if}}
        </span>
      </div>
    </div>
  </div>
</div>